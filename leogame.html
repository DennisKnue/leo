<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>LEO-GAME</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #000;
      color: #fff;
      font-family: 'Courier New', monospace;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: #111;
      touch-action: none;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="400"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let gameState = "start";

    const playerImage = new Image();
    playerImage.src = "ufo.png";

    const player = {
      x: 50,
      y: canvas.height / 2 - 25,
      width: 50,
      height: 50,
      speed: 4,
      isCrashing: false,
      crashAngle: 0,
      crashSpeed: 0.1
    };

    const stars = [];
    const numStars = 150;
    function createStars() {
      for (let i = 0; i < numStars; i++) {
        const size = Math.random() * 2 + 1;
        const speed = Math.random() * 0.2 + 0.1;
        const x = Math.random() * canvas.width;
        const y = Math.random() * canvas.height;
        const depth = Math.random() * 2 + 1;
        stars.push({ x, y, size, speed, depth });
      }
    }
    function drawStars() {
      for (const star of stars) {
        star.x -= star.speed * star.depth;
        if (star.x < 0) {
          star.x = canvas.width;
          star.y = Math.random() * canvas.height;
        }
        ctx.beginPath();
        ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
        ctx.fillStyle = "white";
        ctx.fill();
      }
    }

    const keys = { up: false, down: false, left: false, right: false };
    document.addEventListener("keydown", function(e) {
      if (gameState !== "running") {
        startGame();
      }
      if (e.code === "ArrowUp") keys.up = true;
      if (e.code === "ArrowDown") keys.down = true;
      if (e.code === "ArrowLeft") keys.left = true;
      if (e.code === "ArrowRight") keys.right = true;
    });
    document.addEventListener("keyup", function(e) {
      if (e.code === "ArrowUp") keys.up = false;
      if (e.code === "ArrowDown") keys.down = false;
      if (e.code === "ArrowLeft") keys.left = false;
      if (e.code === "ArrowRight") keys.right = false;
    });

    let touchActive = false;
    let touchTarget = { x: player.x, y: player.y };
    function handleTouch(e) {
      e.preventDefault();
      if (gameState !== "running") {
        startGame();
      }
      touchActive = true;
      const touch = e.touches[0];
      const rect = canvas.getBoundingClientRect();
      touchTarget.x = touch.clientX - rect.left;
      touchTarget.y = touch.clientY - rect.top;
    }
    canvas.addEventListener("touchstart", handleTouch, false);
    canvas.addEventListener("touchmove", handleTouch, false);
    canvas.addEventListener("touchend", function(e) { touchActive = false; }, false);

    let enemies = [];
    const enemySpawnInterval = 2000;
    let lastSpawnTime = Date.now();
    function spawnEnemy() {
      const type = Math.random() < 0.5 ? "stone" : "ufo";
      const enemySize = type === "stone" ? 40 : 50;
      const yPos = Math.random() * (canvas.height - enemySize);
      const speed = type === "stone" ? 3 : 2;
      enemies.push({
        type: type,
        x: canvas.width,
        y: yPos,
        width: enemySize,
        height: enemySize,
        speed: speed
      });
    }
    function rectIntersect(r1, r2) {
      return !(r2.x > r1.x + r1.width ||
               r2.x + r2.width < r1.x ||
               r2.y > r1.y + r1.height ||
               r2.y + r2.height < r1.y);
    }

    let score = 0;
    let startTime = Date.now();

    function startGame() {
      gameState = "running";
      score = 0;
      startTime = Date.now();
      lastSpawnTime = Date.now();
      enemies = [];
      player.x = 50;
      player.y = canvas.height / 2 - 25;
      player.isCrashing = false;
      player.crashAngle = 0;
    }

    function gameOver() {
      gameState = "gameover";
      player.isCrashing = false;
      player.crashAngle = 0;
    }

    function update(deltaTime) {
      if (gameState === "running") {
        score = Math.floor((Date.now() - startTime) / 1000);
        if (Date.now() - lastSpawnTime > enemySpawnInterval) {
          spawnEnemy();
          lastSpawnTime = Date.now();
        }
        if (touchActive) {
          player.x += (touchTarget.x - player.x - player.width / 2) * 0.2;
          player.y += (touchTarget.y - player.y - player.height / 2) * 0.2;
        } else {
          if (keys.up)    player.y -= player.speed;
          if (keys.down)  player.y += player.speed;
          if (keys.left)  player.x -= player.speed;
          if (keys.right) player.x += player.speed;
        }
        if (player.x < 0) player.x = 0;
        if (player.x + player.width > canvas.width) player.x = canvas.width - player.width;
        if (player.y < 0) player.y = 0;
        if (player.y + player.height > canvas.height) player.y = canvas.height - player.height;

        for (let i = enemies.length - 1; i >= 0; i--) {
          const enemy = enemies[i];
          enemy.x -= enemy.speed;
          if (rectIntersect(player, enemy)) {
            player.isCrashing = true;
            gameState = "gameover";
            return;
          }
          if (enemy.x + enemy.width < 0) {
            enemies.splice(i, 1);
          }
        }
      } else if (gameState === "gameover" && player.isCrashing) {
          player.crashAngle += player.crashSpeed;
          player.y += 5;
      }
    }

    function drawPixelEnemyUFO(x, y, width, height) {
      const scale = width / 8;
      ctx.fillStyle = "#ff00ff";
      ctx.fillRect(x, y + scale * 4, scale * 8, scale * 2);
      ctx.fillStyle = "#ff99ff";
      ctx.fillRect(x + scale * 2, y + scale * 2, scale * 4, scale * 2);
      ctx.fillStyle = "#cc0099";
      ctx.fillRect(x + scale * 3, y + scale * 6, scale * 2, scale);
    }
    function drawPixelStone(x, y, width, height) {
      ctx.fillStyle = "#888888";
      ctx.fillRect(x, y, width, height);
      ctx.fillStyle = "#666666";
      ctx.fillRect(x + width * 0
